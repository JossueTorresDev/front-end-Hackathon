<h2 mat-dialog-title>Detalles de Compra #{{purchase.id}}</h2>

<mat-dialog-content>
  <div class="purchase-info">
    <div class="purchase-header">
      <div class="info-group">
        <h3>Información General</h3>
        <p><strong>Fecha:</strong> {{purchase.datePurchase| date:'dd/MM/yyyy'}}</p>
        <p><strong>Cliente:</strong> {{purchase.name}} {{purchase.lastName}}</p>
        <p><strong>Teléfono:</strong> {{purchase.phone}}</p>
        <p><strong>Dirección:</strong> {{purchase.address}}</p>
        <p><strong>Tipo de operación:</strong> {{purchase.operationType}}</p>
        <p><strong>Estado:</strong> {{purchase.status}}</p>
      </div>
      <div class="info-group total-box">
        <h3>Total de Compra</h3>
        <p class="total-amount">{{calculateTotalAmount() | currency:'PEN':'symbol':'1.2-2':'es-PE' }}</p>
      </div>
    </div>
    
    <h3>Productos</h3>
    <div class="table-container">
      <table mat-table [dataSource]="purchase.purchaseDetails" class="mat-elevation-z2">

        <!-- ID Column -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef> ID </th>
          <td mat-cell *matCellDef="let detail"> {{detail.id}} </td>
        </ng-container>

        <!-- Product ID Column -->
        <ng-container matColumnDef="productId">
          <th mat-header-cell *matHeaderCellDef> Producto ID </th>
          <td mat-cell *matCellDef="let detail"> {{detail.productId}} </td>
        </ng-container>

        <!-- Cantidad -->
        <ng-container matColumnDef="productQuantity">
          <th mat-header-cell *matHeaderCellDef> Cantidad </th>
          <td mat-cell *matCellDef="let detail"> {{detail.productQuantity}} </td>
        </ng-container>

        <!-- Precio Unitario -->
        <ng-container matColumnDef="purchasePrice">
          <th mat-header-cell *matHeaderCellDef> Precio Unitario </th>
          <td mat-cell *matCellDef="let detail"> {{detail.purchasePrice | currency:'PEN':'symbol':'1.2-2':'es-PE' }} </td>
        </ng-container>

        <!-- Subtotal -->
        <ng-container matColumnDef="subtotal">
          <th mat-header-cell *matHeaderCellDef> Subtotal </th>
          <td mat-cell *matCellDef="let detail">
            {{calculateSubtotal(detail.productQuantity, detail.purchasePrice) | currency:'PEN':'symbol':'1.2-2':'es-PE' }}
          </td>
        </ng-container>

        <!-- Filas -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-stroked-button color="warn" mat-dialog-close>
    <mat-icon>cancel</mat-icon> Cerrar
  </button>
</mat-dialog-actions>

